#+TITLE: 单片机基础知识
#+DATE: <2017-02-15 Wednesday 20:04:24>
#+TAGS: 单片机
#+PERMALINK: 单片机基础知识
#+VERSION: 0.1
#+CATEGORIES: 单片机
#+LAYOUT: post
#+AUTHOR: yyangdid
#+EMAIL: yyangdid@gmail.com
#+COMMENTS: yes
# -*- eval: (setq org-download-image-dir (file-name-sans-extension (buffer-name))); -*-
#+BEGIN_QUOTE
51 单片机需要的基础知识。
#+END_QUOTE
#+BEGIN_HTML
<!--more-->
#+END_HTML

* 电平特性

  在数字电路中只有两种电平：高电平和低电平。

** 单片机的电平
   数字电路中只有两种电平：高电平和低电平。
   
   + 高电平：5V 或者 3.3V，电压取决于单片机的电源。
   + 低电平：0V
     
** RS232 电平：即计算机串口的电平
   
   + 高电平：-12V
   + 低电平：+12V

   #+BEGIN_QUOTE
   当需要单片机与电脑进行通信的时候，需要通过各种元器件把单片机的电平转换为计算
   机可识别的电平才能与电脑进行通信。
   #+END_QUOTE
   
* 2 进制与 16 进制的表示和转换
  + 二进制、十进制、十六进制简易转换表
    
   | 二进制 | 十进制 | 十六进制 |
   |--------+--------+----------|
   |      0 |      0 |        0 |
   |      1 |      1 |        1 |
   |     10 |      2 |        2 |
   |     11 |      3 |        3 |
   |    100 |      4 |        4 |
   |    101 |      5 |        5 |
   |    110 |      6 |        6 |
   |    111 |      7 |        7 |
   |   1000 |      8 |        8 |
   |   1001 |      9 |        9 |
   |   1010 |     10 |        A |
   |   1011 |     11 |        B |
   |   1100 |     12 |        C |
   |   1101 |     13 |        D |
   |   1110 |     14 |        E |
   |   1111 |     15 |        F |
   |  10000 |     16 | 10       |
    
** 二进制
   由于数字电路中只有两种电平特性，所以计算机中使用的数字都采用的二进制形式的。
   
   二进制是使用 =0= 和 =1= 两个数码来表示的数，它的基数为 =2= ，进位规则是“逢二进一”。
** 十六进制
   十六进制的基数为 =F= ，进位规则是“逢十六进一”。
** 进制转换
*** 十进制转换为二进制
    十进制转换为二进制主要分为这几种情况：正整数转二进制，负整数转二进制，小数转
    二进制。
**** 正整数转二进制
     + =运算方法：=
       
       除二取余，倒序排列，高位补零。

       意思是，将十进制的正整数除以二，得到的商再除以二，依次类推直到商为零或一
       为止，再旁边标出每一步的余数，然后倒着写出来，高位补为零就可以了。

       例如：

       #+ATTR_ORG: :width 300px
       #+ATTR_HTML: :width 300px
       #+ATTR_HTML: :alt (点击图片可放大) 
       [[file:2017-02-15.单片机基础知识/decimal-positive-integer-converted-to-binary_2017-02-15_21-21-55.svg]]
       
**** 负整数转二进制
     + =运算方法：=
       
       将对应的正整数转换为二进制，对二进制取反然后加一。

       例如：

       #+ATTR_ORG: :width 300px
       #+ATTR_HTML: :width 300px
       #+ATTR_HTML: :alt (点击图片可放大)
       [[file:2017-02-15.单片机基础知识/decimal-negative-integer-converted-to-binary_2017-02-15_21-34-27.svg]]

**** 小数转二进制
     + 运算方法：乘二取整，正序排列。

       解释：对被转换的小数乘以 2，取其整数部分（0 或 1）作为二进制小数部分，取其
       小数部分，再乘以 2，再取其整数部分作为二进制小数部分，然后取小数部分，再
       乘以 2，直到小数部分为 0 或者已经去到了足够的位数。每次取的整数部分，按照
       先后次序排列，就是二进制小数。
       
       例如：
       #+ATTR_ORG: :width 300px
       #+ATTR_HTML: :width 300px
       #+ATTR_HTML: :alt (点击图片可放大)
       [[file:2017-02-15.单片机基础知识/decimals-converted-to-binary_2017-02-16_12-01-58.svg]]
*** 二进制转换为十进制
**** 整数二进制转换为十进制
     首先将二进制的位数补齐，首位为 0 则是整数，为 1 则为负数。

     用二进制的每一位数值乘以对应的 2 的幂次，然后依次相加，即为其对应的十进制数
     值。

     例如：
     #+ATTR_ORG: :width 300px
     #+ATTR_HTML: :width 300px
     #+ATTR_HTML: :alt (点击图片可放大)
     [[file:2017-02-15.单片机基础知识/binary-converted-to-integer_2017-02-16_12-24-13.svg]]
**** 小数二进制转换为十进制
     将二进制的每位数字乘以对应位数的 2 的负幂次数，然后相加。

     例如：
     #+ATTR_ORG: :width 300px
     #+ATTR_HTML: :width 300px
     #+ATTR_HTML: :alt (点击图片可放大)
     [[file:2017-02-15.单片机基础知识/binary-converted-to-decimals_2017-02-16_12-56-15.svg]]
*** 十进制转换为十六进制
*** 十六进制转换为十进制
*** 二进制转换为十六进制
*** 十六进制转换为二进制
* 2 进制数的逻辑运算
** =与= 运算
   运算法则：有 0 得 0
   
   例如：
   | 运算式  | 结果 |
   |--------+------|
   | 1&1    |    1 |
   | 1&0    |    0 |
   | 0&0    |    0 |
** =或= 运算
   运算法则：有 1 得 1

   例如：

   注：由于 org-mode 表格中不能使用 =|= ，所以用 =∣= 来代替。
   | 运算式 | 结果 |
   |--------+------|
   | 1∣1    |    1 |
   | 1∣0    |    1 |
   | 0∣0    | 0    |
** =非= 运算
   运算法则：取反

   例如：
   | 运算式 | 结果 |
   |--------+------|
   | ~1     |    0 |
   | ~0     | 1    |
** =异或= 运算
   运算法则：不同为 1，相同为 0

   例如：
   | 运算式 | 结果 |
   |--------+------|
   |    1^1 |    0 |
   |    0^0 |    0 |
   |    1^0 |    1 |
   |    0^1 | 1    |
    
* 8051 单片机介绍
** 80C51 的引脚封装
  #+ATTR_ORG: :width 300px
  #+ATTR_HTML: :width 300px
  #+ATTR_HTML: :alt (点击图片可放大) 
  [[file:2017-02-15.单片机基础知识/80C51-pin-decal_2017-02-16_16-28-39.svg]]
*** P3 口第二功能各引脚功能定义
    | 引脚 | 第二功能标注 | 第二功能解释      |
    |------+--------------+-------------------|
    | P3.0 | RXD          | 串行口输入        |
    | P3.1 | TXD          | 串行口输出        |
    | P3.2 | INT0         | 外部中断 0 输入   |
    | P3.3 | INT1         | 外部中断 1 输入   |
    | P3.4 | T0           | 定时器 0 外部输入 |
    | P3.5 | T1           | 定时器 1 外部输入 |
    | P3.6 | WR           | 外部写控制        |
    | P3.7 | RD           | 外部读控制        |
** 8051 内部结构
   #+ATTR_ORG: :width 300px
   #+ATTR_HTML: :width 300px
   #+ATTR_HTML: :alt (点击图片可放大)
   [[file:2017-02-15.单片机基础知识/8051-internal-structure_2017-02-16_17-53-05.svg]]
   
** 总线(BUS)
     
     总线(BUS)是计算机各不见之间传送信息的公共通道。
     
     总线分为两类：
      
     + 内部总线
       
       内部总线是 CPU 内部之间的连线。

     + 外部总线

       外部总线是 CPU 与其他部件之间的连线。

       外部总线分为三种：
       
       + 数据总线 DB (Date Bus)

       + 地址总线 AB (Address Bus)

       + 控制总线 CB (Control Bus)
** 单片机的构成
   + CPU

     由运算和控制逻辑组成，同时还包括中断系统和部分外部特殊功能寄存器。

   + RAM

     用来存放可以读写的数据，如运算的中间结果、最终结果以及欲显示的数据。

   + ROM
     
     用来存放程序、原始数据和表格。

   + I/O

     四个 8 位并行 I/O 口，即可用作输入，也可用作输出。

   + T/C

     两个定时/计数器，即可工作在定时模式，也可工作在记数模式。

   + 五个中断源的中断控制系统。

   + 一个全双工 UART (同样异步接收发送器) 的串行 I/O 口，用于实现单片机之间或单
     片机与计算机之间的串行通信。

   + 片内振荡器和时钟产生电路，石英晶体和微调电容需要外接。最高震荡频率取决于单
     片机型号和性能。
** 单片机工作的基本时序
   #+ATTR_ORG: :width 300px
   #+ATTR_HTML: :width 300px
   #+ATTR_HTML: :alt (点击图片可放大) 
   [[file:2017-02-15.单片机基础知识/8051-basic-timing_2017-02-20_20-12-26.svg]]
*** 震荡周期
    震荡周期也称为时钟周期，是指为单片机提供时钟脉冲信号的震荡源的周期，开发板上
    为 12MHZ。
*** 状态周期
    每个状态周期为时钟周期的 2 倍，是震荡周期经二分频后得到的。
*** 机器周期
    一个机器周期包含 6 个状态周期 S1~S6 ，也就是 12 个时钟周期。在一个机器周期内，
    CPU 可以完成一个独立的操作。
*** 指令周期
    是指 CPU 完成一条操作所需要的全部时间。每条指令执行时间都是有一个或几个机器
    周期组成。MCS-51 系统中，有单周期指令、双周期指令和四周期指令。
** 单片机主要学习什么
   + 对 I/O 口的控制，无论单片机对外接进行何种控制，都是通过 I/O 口进行的。
   + 接收外部的控制，通过 I/O 来感受外部的电压。
   + 51 单片机总共有 P0 、P1、P2、P3 四个 8 位双向输入输出端口(I/O)，每个端口都
     有锁存器、输出驱动器和输入缓冲器。4 个 I/O 端口都能作输入输出口用。
*** 单片机 I/O 口的结构
    单片机 I/O 口分为三种：开漏输出、准双向 IO 、强推挽输出。

    51 单片机使用 =开漏输出= 和 =准双向 IO= 。

    P0 口没有内部的上拉电阻，只能借助外部上拉电阻，使用 =开漏输出= 。其他口使用 =准双向 IO= 。

    + 开漏输出
     #+ATTR_ORG: :width 300px
     #+ATTR_HTML: :width 300px
     #+ATTR_HTML: :alt (点击图片可放大)
     [[file:2017-02-15.单片机基础知识/scm-0002_2017-02-20_21-02-47.svg]]
    + 准双向 IO
     #+ATTR_ORG: :width 300px
     #+ATTR_HTML: :width 300px
     #+ATTR_HTML: :alt (点击图片可放大) 
     [[file:2017-02-15.单片机基础知识/scm-0001_2017-02-20_20-31-27.svg]]
    + 强推挽输出
     #+ATTR_ORG: :width 300px
     #+ATTR_HTML: :width 300px
     #+ATTR_HTML: :alt (点击图片可放大)
     [[file:2017-02-15.单片机基础知识/scm-0003_2017-02-20_21-24-35.svg]]
*** 上下拉电阻
    + 概念

    上拉电阻就是将不确定的信号通过一个电阻拉到高电平，同时此电阻起到一
    个限流的作用。下拉电阻就是下拉倒低电平。

    + 上拉电阻的作用

      + OC 门(在开漏输出电路中)要输出高电平，外部必须加上拉电阻。

      + 加大普通 IO 口的驱动能力。

      + 起到限流的作用。

      + 抵抗电磁干扰。
    + 上拉电阻的选取原则

      + 从降低功耗方面考虑应该足够大，因为电阻越大，电流越小。

      + 从确保足够的引脚驱动能力考虑应该足够小，电阻越小，电流越大。

      + 开漏输出时，过大的上拉电阻会导致信号的上升沿变缓。

       #+ATTR_ORG: :width 300px
       #+ATTR_HTML: :width 300px
       #+ATTR_HTML: :alt (点击图片可放大)
       [[file:2017-02-15.单片机基础知识/scm-0004_2017-02-20_21-58-33.svg]]
* C51 基础知识
